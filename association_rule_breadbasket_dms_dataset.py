# -*- coding: utf-8 -*-
"""Association Rule - BreadBasket_DMS Dataset.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1r0iEJHrMZ1gpY6mPw1IkHGXxn_8N5jfw
"""

pip install pandas mlxtend

import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
from mlxtend.frequent_patterns import apriori
from mlxtend.frequent_patterns import association_rules
import mlxtend as ml

data = pd.read_csv('BreadBasket_DMS.csv')
data.head()

sns.countplot(x='Item', data = data, order = data['Item'].value_counts().iloc[:10].index)
plt.xticks(rotation=90)
plt.title('10 Most Populer Items from DMS Bakery', fontsize = 15)

df = data.groupby(['Transaction','Item']).size().reset_index(name='count')
df.head

keranjang = (df.groupby(['Transaction', 'Item'])['count']
             .sum().unstack().reset_index().fillna(0)
             .set_index('Transaction'))
keranjang.head(15)

def encode_units(x):
  if x <= 0:
    return 0
  if x >= 1:
    return 1

keranjang_set = keranjang.applymap(encode_units)
keranjang_set.head()

frequent_itemsets = apriori(keranjang_set, min_support = 0.01, use_colnames=True)
frequent_itemsets.head()

rules = association_rules(frequent_itemsets, metric="lift")
rules.sort_values('confidence',ascending = False, inplace = True)
rules.shape

rules.head(10)